# 15 | 二分查找（上）：如何用最省内存的方式实现快速查找功能？

## 什么是二分查找？

- 折半查找
- 二分思想，每次都与中间的数据比较，将待查找区间缩小为之前的一半，直到找到要查找的元素，或者减少为0

## 时间复杂度分析

- 时间复杂度为logn
- 空间的大小变化，n、n/2、n/4……n/2^k=1，即k次查找，k=logn
- 对数的恐怖，2^32次方是42亿，也只需要32次
- 指数同样恐怖

## 二分查找的实现

3处需要注意的点

- 循环退出条件，while(low<=high)
- mid的取值，mid=low+(high-low)/2
- low和high的更新，low=mid-1，high=mid+1，这样避免死循环

## 二分查找的场景

- 二分查找依赖顺序表结构，即数组（需要下标的随机访问）
- 二分查找针对有序数据（一次排序多次查找，动态集合需要维护有序不适合）
- 适合静态数据
- 数据量太小不适合二分查找（太小二分查找和遍历差不多，数据比较耗时时无论大小多少都推荐二分查找）
- 数据量太大也不适合二分查找（需要连续的内存空间）

## 开篇问题

1000万数据判断是否存在

- 二分查找最适合，大小刚好合适

## 课后思考

### 如何求一个数的平方根？要求精确到小数点后6位。

- 二分查找思想，一次取中间值
- 退出条件：(mid+0.000001)\*(mid+0.000001)>x && (mid-0.000001)\*(mid-0.000001)<x
- 然后mid替换成low和high

### 链表实现二分查找时间复杂度分析？

#### 如果是双向链表

- N = n/2 + n/4 +n/8 + ... + 1 
- N/2 =       n/4 + n/8 + ...+ 1 + 1/2
- N/2 = n/2 -1/2
- N=n-1
- 时间复杂度为O(n)



# 16 | 二分查找（下）：如何快速定位IP对应的省份地址？

## 二分查找变形问题（包含重复元素的）

- 查找第一个元素等于给定值的元素
- 查找最后一个元素等于给定值的元素
- 查找第一个大于等于给定值的元素
- 查找最后一个小于等于给定值的元素

## 变体一：查找第一个等于给定值的元素

- 如果查找到给定值，判定如果到头或者前面一个元素不等于给定值，则返回；如果相等则，high=mid-1，同理继续往前找

## 变体二：查找最后一个等于给定值的元素

- 如果查找到给定值，判定如果到尾或者后面一个元素不等于给定值，则返回；如果相等，low = mid+1，同理继续往后找

### 变体三：查找第一个大于等于给定值的元素

- 如果值大于等于给定值，如果到0了，或者前面值小于给定值了，说明这就是结果；如果值小于给定值，low = mid + 1

### 变体四：查找最后一个小于等于给定值的元素

- 如果值小于等于给定值，如果到数组最后面或者后面的值大于给定值了，说明就是结果；如果值大于给定值了，high = mid - 1

## 二分查找注意点

- 二分查找能解决的，给定值查找推荐使用散列表和二叉查找树
- 二分查找更适合解决变体的近似问题，变体问题散列表、二叉树比较难实现
- 二分查找的注意点：终止条件（low<=high）、区间上下界更新方法（更新low还是high）、返回值选择（何时返回值mid）

## 开篇问题

快速定位ip地址的归属？

- ip转换成32位整数
- 转换为变体四，查找最后一个小于等于给定值的元素

## 课后思考

如何使用二分查找，搜索循环的有序数组，例如4，5，6，1，2，3？(leetcode的33题)

解法一：（自己想的）

- 先通过一次二分查找，查找循环数组的起始节点k（这个写法不好写）
- 然后给定值，数组头、起始节点k，比较看是落在这两个数组的那个区间内

解法二：

我们发现循环数组存在一个性质：以数组中间点为分区，会将数组分成一个有序数组和一个循环有序数组。

- 如果首元素小于 mid，说明前半部分是有序的，后半部分是循环有序数组；
- 如果首元素大于 mid，说明后半部分是有序的，前半部分是循环有序的数组；
- 如果目标元素在有序数组范围中，使用二分查找；
- 如果目标元素在循环有序数组中，设定数组边界后，使用以上方法继续查找。（递归实现）